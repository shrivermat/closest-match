# Quick Deployment Reference

## ğŸš€ Common Development Workflows

### Fresh Start / Clean Build
```bash
npm run build          # Build everything (WASM + TypeScript)
cp pkg/document_annotator.js dist/
cp pkg/document_annotator_bg.wasm dist/
npm run dev            # Start development server
```

### After Rust Changes
```bash
npm run build:wasm     # Build WASM only
cp pkg/document_annotator.js dist/
cp pkg/document_annotator_bg.wasm dist/
# Hard refresh browser (Ctrl+Shift+R)
```

### After TypeScript Changes
```bash
npm run build:js       # Build TypeScript only
# Hard refresh browser (Ctrl+Shift+R)
```

### After HTML Playground Changes
```bash
# No build needed - just refresh browser
# Files: dist/index.html
```

## ğŸ” Troubleshooting Checklist

### âŒ PDF "Expected a string object" Error
**Fix:** Use `PDFLib.PDFString.of()` for annotation contents
```javascript
Contents: PDFLib.PDFString.of("Your text here")
```

### âŒ Annotations Not Selectable
**Fix:** Use annotation objects with F: 4 flag
```javascript
const annotation = pdfDoc.context.obj({
    Type: 'Annot',
    F: 4, // Makes annotation selectable
    Contents: PDFLib.PDFString.of("Text")
});
```

### âŒ Interactive Playground Broken
**Check:**
- Event listeners attached on page load
- DocumentAnnotator class available globally
- Async function wrapper for code execution

### âŒ WASM Functions Not Available
**Check:**
```bash
ls -la dist/document_annotator_bg.wasm  # File exists?
# Browser Network tab: WASM loads successfully (200 OK)
# Console: wasmFunctions.get_version() returns "0.4.0"
```

### âŒ TypeScript Changes Not Showing
**Solution:**
1. `npm run build:js`
2. Hard refresh browser
3. Check `dist/index.js` timestamp

## ğŸ“ File Locations

### Source Files (Editable)
- **Rust:** `src/*.rs` â†’ Build required
- **TypeScript:** `src/*.ts` â†’ Build required  
- **HTML Playground:** `dist/index.html` â†’ No build required

### Build Output (Generated)
- **WASM:** `pkg/document_annotator_bg.wasm` â†’ Copy to `dist/`
- **JS Bindings:** `pkg/document_annotator.js` â†’ Copy to `dist/`
- **TS Bundle:** `dist/index.js` â†’ Generated by webpack

## ğŸ¯ Version Check
```javascript
// In browser console:
wasmFunctions.get_version(); // Should return "0.4.0"
```

## ğŸ“¦ Two Annotation Systems

1. **TypeScript Bundle** (`src/pdf-annotator.ts`)
   - Used by: Compiled applications
   - Build: `npm run build:js`
   
2. **HTML Playground** (`dist/index.html`)
   - Used by: Interactive demo
   - Build: None (direct edit)

**Important:** Changes to one don't affect the other!